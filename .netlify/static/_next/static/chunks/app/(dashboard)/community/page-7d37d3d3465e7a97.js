(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{5278:function(e,t,s){Promise.resolve().then(s.bind(s,1322))},9496:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(7461).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},6490:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(7461).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2518:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9733:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(7461).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},1322:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var i=s(3827),l=s(4090),a=s(8792),r=s(7269),n=s(1097),c=s(575),d=s(6862),o=s(2518),u=s(9733),m=s(6490),x=s(9496),h=s(5211);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,s(7461).Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var f=s(7841),j=s(5323),v=s(2805);function _(){let{profile:e}=(0,r.a)(),{toast:t}=(0,d.pm)(),[s,_]=(0,l.useState)([]),[g,b]=(0,l.useState)(!0),[N,k]=(0,l.useState)("trending");(0,l.useEffect)(()=>{w()},[N,e]);let w=async()=>{let t=(0,n.e)(),s=t.from("projects").select("\n        *,\n        users!projects_user_id_fkey(id, display_name, avatar_url, level),\n        project_likes(count)\n      ").eq("is_public",!0);"trending"===N?s=s.order("view_count",{ascending:!1}):"latest"===N?s=s.order("created_at",{ascending:!1}):"featured"===N&&(s=s.eq("is_featured",!0).order("created_at",{ascending:!1}));let{data:i,error:l}=await s.limit(20);if(i&&!l){let s=new Set,l=new Set;if(e){let{data:i}=await t.from("project_likes").select("project_id").eq("user_id",e.id),{data:a}=await t.from("user_bookmarks").select("project_id").eq("user_id",e.id);s=new Set(null==i?void 0:i.map(e=>e.project_id)),l=new Set(null==a?void 0:a.map(e=>e.project_id))}_(i.map(e=>{var t,i;return{id:e.id,title:e.title,description:e.description,thumbnail_url:e.thumbnail_url,view_count:e.view_count||0,like_count:(null===(i=e.project_likes)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.count)||0,comment_count:0,created_at:e.created_at,user:{id:e.users.id,display_name:e.users.display_name||"Anonymous",avatar_url:e.users.avatar_url,level:e.users.level},is_liked:s.has(e.id),is_bookmarked:l.has(e.id)}}))}b(!1)},y=async i=>{if(!e){t({title:"请先登录",description:"登录后即可点赞作品",variant:"destructive"});return}let l=(0,n.e)(),a=s.find(e=>e.id===i);(null==a?void 0:a.is_liked)?await l.from("project_likes").delete().eq("user_id",e.id).eq("project_id",i):await l.from("project_likes").insert({user_id:e.id,project_id:i}),w()},Z=async i=>{if(!e){t({title:"请先登录",description:"登录后即可收藏作品",variant:"destructive"});return}let l=(0,n.e)(),a=s.find(e=>e.id===i);(null==a?void 0:a.is_bookmarked)?(await l.from("user_bookmarks").delete().eq("user_id",e.id).eq("project_id",i),t({title:"已取消收藏"})):(await l.from("user_bookmarks").insert({user_id:e.id,project_id:i}),t({title:"收藏成功!"})),w()};return(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6",children:(0,i.jsxs)("div",{className:"mx-auto max-w-7xl",children:[(0,i.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"mb-2 text-3xl font-bold text-gray-900",children:"作品展示"}),(0,i.jsx)("p",{className:"text-gray-600",children:"发现优秀作品,获取创作灵感"})]}),(0,i.jsx)(a.default,{href:"/projects/new",children:(0,i.jsxs)(c.z,{className:"gap-2",children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),"发布作品"]})})]}),(0,i.jsxs)("div",{className:"mb-6 flex gap-2",children:[(0,i.jsxs)(c.z,{variant:"trending"===N?"default":"outline",onClick:()=>k("trending"),className:"gap-2",children:[(0,i.jsx)(u.Z,{className:"h-4 w-4"}),"热门"]}),(0,i.jsxs)(c.z,{variant:"latest"===N?"default":"outline",onClick:()=>k("latest"),className:"gap-2",children:[(0,i.jsx)(m.Z,{className:"h-4 w-4"}),"最新"]}),(0,i.jsxs)(c.z,{variant:"featured"===N?"default":"outline",onClick:()=>k("featured"),className:"gap-2",children:[(0,i.jsx)(x.Z,{className:"h-4 w-4"}),"精选"]})]}),g?(0,i.jsx)("div",{className:"py-12 text-center",children:(0,i.jsx)("div",{className:"loading-spinner mx-auto"})}):s.length>0?(0,i.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:s.map(e=>(0,i.jsxs)("div",{className:"group overflow-hidden rounded-xl border bg-white shadow-sm transition-all hover:shadow-lg",children:[(0,i.jsx)(a.default,{href:"/projects/".concat(e.id),children:(0,i.jsx)("div",{className:"aspect-video overflow-hidden bg-gradient-to-br from-blue-100 to-purple-100",children:e.thumbnail_url?(0,i.jsx)("img",{src:e.thumbnail_url,alt:e.title,className:"h-full w-full object-cover transition-transform group-hover:scale-105"}):(0,i.jsx)("div",{className:"flex h-full items-center justify-center text-4xl",children:"\uD83C\uDFA8"})})}),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)(a.default,{href:"/projects/".concat(e.id),children:(0,i.jsx)("h3",{className:"mb-2 line-clamp-2 text-lg font-semibold text-gray-900 hover:text-blue-600",children:e.title})}),(0,i.jsx)("p",{className:"mb-4 line-clamp-2 text-sm text-gray-600",children:e.description}),(0,i.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,i.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-400 to-purple-400 text-sm font-semibold text-white",children:e.user.avatar_url?(0,i.jsx)("img",{src:e.user.avatar_url,alt:e.user.display_name,className:"h-full w-full rounded-full object-cover"}):e.user.display_name[0]}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.user.display_name}),(0,i.jsxs)("div",{className:"text-xs text-gray-500",children:["Level ",e.user.level]})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between border-t pt-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,i.jsxs)("button",{onClick:()=>y(e.id),className:"flex items-center gap-1 transition-colors hover:text-red-500 ".concat(e.is_liked?"text-red-500":""),children:[(0,i.jsx)(h.Z,{className:"h-4 w-4 ".concat(e.is_liked?"fill-current":"")}),(0,i.jsx)("span",{children:e.like_count})]}),(0,i.jsxs)(a.default,{href:"/projects/".concat(e.id,"#comments"),className:"flex items-center gap-1 hover:text-blue-600",children:[(0,i.jsx)(p,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.comment_count})]}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(f.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.view_count})]})]}),(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)("button",{onClick:()=>Z(e.id),className:"rounded p-1.5 transition-colors hover:bg-gray-100 ".concat(e.is_bookmarked?"text-yellow-500":"text-gray-400"),children:(0,i.jsx)(j.Z,{className:"h-4 w-4 ".concat(e.is_bookmarked?"fill-current":"")})}),(0,i.jsx)("button",{className:"rounded p-1.5 text-gray-400 transition-colors hover:bg-gray-100",children:(0,i.jsx)(v.Z,{className:"h-4 w-4"})})]})]})]})]},e.id))}):(0,i.jsxs)("div",{className:"rounded-2xl border bg-white p-12 text-center shadow-lg",children:[(0,i.jsx)("div",{className:"mx-auto mb-4 text-6xl",children:"\uD83C\uDFA8"}),(0,i.jsx)("h3",{className:"mb-2 text-xl font-semibold text-gray-700",children:"暂无作品"}),(0,i.jsx)("p",{className:"text-gray-600",children:"成为第一个发布作品的人吧!"})]})]})})}}},function(e){e.O(0,[150,491,792,269,44,971,69,744],function(){return e(e.s=5278)}),_N_E=e.O()}]);