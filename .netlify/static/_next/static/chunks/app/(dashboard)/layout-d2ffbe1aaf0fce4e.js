(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{6822:function(e,s,t){Promise.resolve().then(t.bind(t,3007))},4562:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]])},6490:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},403:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},9910:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1213:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2235:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3007:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var a=t(3827),l=t(4090),r=t(7907),n=t(7269);function i(e){let{children:s,requireAuth:t=!1,requiredRole:i}=e,c=(0,r.useRouter)(),{user:d,profile:o,loading:h,isGuest:x,isTrialValid:u}=(0,n.a)();return((0,l.useEffect)(()=>{if(!h){if(!d){c.push("/login");return}if(t&&x&&!u){c.push("/register");return}if(i&&o){let e={guest:0,student:1,teacher:2,admin:3};if(e[o.role]<e[i]){c.push("/");return}}}},[d,o,h,x,u,t,i,c]),h)?(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"加载中..."})]})}):!d||t&&x&&!u?null:(0,a.jsx)(a.Fragment,{children:s})}var c=t(8792),d=t(6490),o=t(8727),h=t(2235),x=t(575),u=t(94);function m(){let{isGuest:e,isTrialValid:s,trialDaysRemaining:t}=(0,n.a)(),[r,i]=(0,l.useState)(!1);if(!e||r||!s||!(0,u.Xd)(t))return null;let m=(0,u.be)(t);return(0,a.jsx)("div",{className:"relative ".concat(0===t?"bg-red-500 text-white":t<=1?"bg-orange-500 text-white":t<=3?"bg-yellow-500 text-black":"bg-blue-500 text-white"),children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 shrink-0"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:m})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(c.default,{href:"/register",children:(0,a.jsxs)(x.z,{size:"sm",variant:0===t?"secondary":"outline",className:0===t?"bg-white text-red-600 hover:bg-gray-100":"border-white text-white hover:bg-white/10",children:[(0,a.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"立即注册"]})}),(0,a.jsx)("button",{onClick:()=>i(!0),className:"shrink-0 rounded p-1 hover:bg-white/10","aria-label":"关闭",children:(0,a.jsx)(h.Z,{className:"h-5 w-5"})})]})]})})})}var f=t(7698),g=t(7461);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,g.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);var j=t(4562),p=t(403),b=t(4059),v=t(6260),N=t(1213),w=t(9910);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let k=(0,g.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Z=(0,g.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);function z(){let e=(0,r.usePathname)(),s=(0,r.useRouter)(),{profile:t,signOut:i}=(0,n.a)(),[d,o]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1);if("/"===e||e.startsWith("/login")||e.startsWith("/register"))return null;let g=[{name:"首页",href:"/dashboard",icon:y},{name:"学习",href:"/learn",icon:j.Z},{name:"编辑器",href:"/editor",icon:p.Z},{name:"社区",href:"/community",icon:b.Z},{name:"排行榜",href:"/leaderboard",icon:v.Z}],z=async()=>{await i(),s.push("/")};return(0,a.jsx)("header",{className:"sticky top-0 z-50 border-b bg-white/80 backdrop-blur-lg",children:(0,a.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,a.jsxs)(c.default,{href:"/dashboard",className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-600 to-purple-600 text-xl font-bold text-white",children:"\uD83C\uDFAE"}),(0,a.jsx)("span",{className:"hidden text-xl font-bold text-gray-900 sm:block",children:"GameCode Lab"})]}),(0,a.jsx)("nav",{className:"hidden items-center gap-1 md:flex",children:g.map(s=>{let t=s.icon,l=e===s.href||e.startsWith(s.href+"/");return(0,a.jsx)(c.default,{href:s.href,children:(0,a.jsxs)(x.z,{variant:l?"default":"ghost",size:"sm",className:"gap-2",children:[(0,a.jsx)(t,{className:"h-4 w-4"}),s.name]})},s.name)})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsx)(f.U,{level:t.level,size:"sm"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>m(!u),className:"flex items-center gap-2 rounded-lg p-2 hover:bg-gray-100",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-400 to-purple-400 text-sm font-semibold text-white",children:t.avatar_url?(0,a.jsx)("img",{src:t.avatar_url,alt:t.display_name||"User",className:"h-full w-full rounded-full object-cover"}):(t.display_name||t.username||"U")[0]}),(0,a.jsx)("span",{className:"hidden text-sm font-medium text-gray-900 md:block",children:t.display_name||t.username})]}),u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>m(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 top-12 z-20 w-56 rounded-lg border bg-white p-2 shadow-lg",children:[(0,a.jsx)(c.default,{href:"/profile",children:(0,a.jsxs)("button",{onClick:()=>m(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),"个人中心"]})}),("teacher"===t.role||"admin"===t.role)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.default,{href:"/teacher",children:(0,a.jsxs)("button",{onClick:()=>m(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),"教师工作台"]})}),"admin"===t.role&&(0,a.jsx)(c.default,{href:"/admin",children:(0,a.jsxs)("button",{onClick:()=>m(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),"管理后台"]})})]}),(0,a.jsx)("div",{className:"my-2 h-px bg-gray-200"}),(0,a.jsxs)("button",{onClick:z,className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-red-600 hover:bg-red-50",children:[(0,a.jsx)(k,{className:"h-4 w-4"}),"退出登录"]})]})]})]})]}):(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.default,{href:"/login",children:(0,a.jsx)(x.z,{variant:"ghost",size:"sm",children:"登录"})}),(0,a.jsx)(c.default,{href:"/register",children:(0,a.jsx)(x.z,{size:"sm",children:"注册"})})]}),(0,a.jsx)("button",{onClick:()=>o(!d),className:"rounded-lg p-2 text-gray-600 hover:bg-gray-100 md:hidden",children:d?(0,a.jsx)(h.Z,{className:"h-6 w-6"}):(0,a.jsx)(Z,{className:"h-6 w-6"})})]})]}),d&&(0,a.jsx)("div",{className:"border-t py-4 md:hidden",children:(0,a.jsx)("nav",{className:"flex flex-col gap-2",children:g.map(s=>{let t=s.icon,l=e===s.href;return(0,a.jsx)(c.default,{href:s.href,children:(0,a.jsxs)(x.z,{variant:l?"default":"ghost",size:"sm",className:"w-full justify-start gap-2",onClick:()=>o(!1),children:[(0,a.jsx)(t,{className:"h-4 w-4"}),s.name]})},s.name)})})})]})})}function C(e){let{children:s}=e;return(0,a.jsx)(i,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(z,{}),(0,a.jsx)(m,{}),(0,a.jsx)("main",{children:s})]})})}},7698:function(e,s,t){"use strict";t.d(s,{U:function(){return n}});var a=t(3827),l=t(6260),r=t(2169);function n(e){let{level:s,size:t="md",showTitle:n=!0}=e,i=(0,r.yF)(s);return(0,a.jsxs)("div",{className:"inline-flex flex-col items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex items-center justify-center rounded-full bg-gradient-to-br ".concat(s>=10?"from-orange-400 to-red-500":s>=8?"from-purple-400 to-pink-500":s>=5?"from-blue-400 to-cyan-500":"from-gray-400 to-gray-500"," ").concat({sm:"h-10 w-10 text-sm",md:"h-16 w-16 text-lg",lg:"h-24 w-24 text-2xl"}[t]," shadow-lg"),children:[(0,a.jsx)("div",{className:"absolute inset-1 flex items-center justify-center rounded-full bg-white/20",children:(0,a.jsx)("span",{className:"font-bold text-white",children:s})}),(0,a.jsx)(l.Z,{className:"absolute -right-1 -top-1 h-5 w-5 text-yellow-400"})]}),n&&(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:i})]})}}},function(e){e.O(0,[150,491,792,269,392,971,69,744],function(){return e(e.s=6822)}),_N_E=e.O()}]);