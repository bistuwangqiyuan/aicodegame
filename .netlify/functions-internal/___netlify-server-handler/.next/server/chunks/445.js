exports.id=445,exports.ids=[445],exports.modules={8638:(e,s,t)=>{Promise.resolve().then(t.bind(t,911))},911:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>z});var r=t(5344),a=t(3729),l=t(8428),n=t(6700);function i({children:e,requireAuth:s=!1,requiredRole:t}){let i=(0,l.useRouter)(),{user:d,profile:c,loading:x,isGuest:h,isTrialValid:m}=(0,n.a)();return((0,a.useEffect)(()=>{if(!x){if(!d){i.push("/login");return}if(s&&h&&!m){i.push("/register");return}if(t&&c){let e={guest:0,student:1,teacher:2,admin:3};if(e[c.role]<e[t]){i.push("/");return}}}},[d,c,x,h,m,s,t,i]),x)?r.jsx("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"loading-spinner mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"加载中..."})]})}):!d||s&&h&&!m?null:r.jsx(r.Fragment,{children:e})}var d=t(6506),c=t(7189),x=t(473),h=t(4513),m=t(5094),o=t(6797);function u(){let{isGuest:e,isTrialValid:s,trialDaysRemaining:t}=(0,n.a)(),[l,i]=(0,a.useState)(!1);if(!e||l||!s||!(0,o.Xd)(t))return null;let u=(0,o.be)(t);return r.jsx("div",{className:`relative ${0===t?"bg-red-500 text-white":t<=1?"bg-orange-500 text-white":t<=3?"bg-yellow-500 text-black":"bg-blue-500 text-white"}`,children:r.jsx("div",{className:"container mx-auto px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(c.Z,{className:"h-5 w-5 shrink-0"}),r.jsx("p",{className:"text-sm font-medium",children:u})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx(d.default,{href:"/register",children:(0,r.jsxs)(m.z,{size:"sm",variant:0===t?"secondary":"outline",className:0===t?"bg-white text-red-600 hover:bg-gray-100":"border-white text-white hover:bg-white/10",children:[r.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"立即注册"]})}),r.jsx("button",{onClick:()=>i(!0),className:"shrink-0 rounded p-1 hover:bg-white/10","aria-label":"关闭",children:r.jsx(h.Z,{className:"h-5 w-5"})})]})]})})})}var f=t(4538),g=t(2086),j=t(3211),p=t(4826),b=t(9895),N=t(782),v=t(8822),w=t(3746),y=t(8120),k=t(8200);function Z(){let e=(0,l.usePathname)(),s=(0,l.useRouter)(),{profile:t,signOut:i}=(0,n.a)(),[c,x]=(0,a.useState)(!1),[o,u]=(0,a.useState)(!1);if("/"===e||e.startsWith("/login")||e.startsWith("/register"))return null;let Z=[{name:"首页",href:"/dashboard",icon:g.Z},{name:"学习",href:"/learn",icon:j.Z},{name:"编辑器",href:"/editor",icon:p.Z},{name:"社区",href:"/community",icon:b.Z},{name:"排行榜",href:"/leaderboard",icon:N.Z}],z=async()=>{await i(),s.push("/")};return r.jsx("header",{className:"sticky top-0 z-50 border-b bg-white/80 backdrop-blur-lg",children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsxs)(d.default,{href:"/dashboard",className:"flex items-center gap-2",children:[r.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-600 to-purple-600 text-xl font-bold text-white",children:"\uD83C\uDFAE"}),r.jsx("span",{className:"hidden text-xl font-bold text-gray-900 sm:block",children:"GameCode Lab"})]}),r.jsx("nav",{className:"hidden items-center gap-1 md:flex",children:Z.map(s=>{let t=s.icon,a=e===s.href||e.startsWith(s.href+"/");return r.jsx(d.default,{href:s.href,children:(0,r.jsxs)(m.z,{variant:a?"default":"ghost",size:"sm",className:"gap-2",children:[r.jsx(t,{className:"h-4 w-4"}),s.name]})},s.name)})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[t?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"hidden sm:block",children:r.jsx(f.U,{level:t.level,size:"sm"})}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>u(!o),className:"flex items-center gap-2 rounded-lg p-2 hover:bg-gray-100",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-400 to-purple-400 text-sm font-semibold text-white",children:t.avatar_url?r.jsx("img",{src:t.avatar_url,alt:t.display_name||"User",className:"h-full w-full rounded-full object-cover"}):(t.display_name||t.username||"U")[0]}),r.jsx("span",{className:"hidden text-sm font-medium text-gray-900 md:block",children:t.display_name||t.username})]}),o&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>u(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 top-12 z-20 w-56 rounded-lg border bg-white p-2 shadow-lg",children:[r.jsx(d.default,{href:"/profile",children:(0,r.jsxs)("button",{onClick:()=>u(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[r.jsx(v.Z,{className:"h-4 w-4"}),"个人中心"]})}),("teacher"===t.role||"admin"===t.role)&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(d.default,{href:"/teacher",children:(0,r.jsxs)("button",{onClick:()=>u(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[r.jsx(j.Z,{className:"h-4 w-4"}),"教师工作台"]})}),"admin"===t.role&&r.jsx(d.default,{href:"/admin",children:(0,r.jsxs)("button",{onClick:()=>u(!1),className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-gray-700 hover:bg-gray-100",children:[r.jsx(w.Z,{className:"h-4 w-4"}),"管理后台"]})})]}),r.jsx("div",{className:"my-2 h-px bg-gray-200"}),(0,r.jsxs)("button",{onClick:z,className:"flex w-full items-center gap-3 rounded-lg px-4 py-2 text-left text-red-600 hover:bg-red-50",children:[r.jsx(y.Z,{className:"h-4 w-4"}),"退出登录"]})]})]})]})]}):(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(d.default,{href:"/login",children:r.jsx(m.z,{variant:"ghost",size:"sm",children:"登录"})}),r.jsx(d.default,{href:"/register",children:r.jsx(m.z,{size:"sm",children:"注册"})})]}),r.jsx("button",{onClick:()=>x(!c),className:"rounded-lg p-2 text-gray-600 hover:bg-gray-100 md:hidden",children:c?r.jsx(h.Z,{className:"h-6 w-6"}):r.jsx(k.Z,{className:"h-6 w-6"})})]})]}),c&&r.jsx("div",{className:"border-t py-4 md:hidden",children:r.jsx("nav",{className:"flex flex-col gap-2",children:Z.map(s=>{let t=s.icon,a=e===s.href;return r.jsx(d.default,{href:s.href,children:(0,r.jsxs)(m.z,{variant:a?"default":"ghost",size:"sm",className:"w-full justify-start gap-2",onClick:()=>x(!1),children:[r.jsx(t,{className:"h-4 w-4"}),s.name]})},s.name)})})})]})})}function z({children:e}){return r.jsx(i,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(Z,{}),r.jsx(u,{}),r.jsx("main",{children:e})]})})}},4538:(e,s,t)=>{"use strict";t.d(s,{U:()=>n});var r=t(5344),a=t(782),l=t(1453);function n({level:e,size:s="md",showTitle:t=!0}){let n=(0,l.yF)(e);return(0,r.jsxs)("div",{className:"inline-flex flex-col items-center gap-2",children:[(0,r.jsxs)("div",{className:`relative flex items-center justify-center rounded-full bg-gradient-to-br ${e>=10?"from-orange-400 to-red-500":e>=8?"from-purple-400 to-pink-500":e>=5?"from-blue-400 to-cyan-500":"from-gray-400 to-gray-500"} ${{sm:"h-10 w-10 text-sm",md:"h-16 w-16 text-lg",lg:"h-24 w-24 text-2xl"}[s]} shadow-lg`,children:[r.jsx("div",{className:"absolute inset-1 flex items-center justify-center rounded-full bg-white/20",children:r.jsx("span",{className:"font-bold text-white",children:e})}),r.jsx(a.Z,{className:"absolute -right-1 -top-1 h-5 w-5 text-yellow-400"})]}),t&&r.jsx("span",{className:"text-sm font-medium text-gray-700",children:n})]})}},5021:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>a,default:()=>n});let r=(0,t(6843).createProxy)(String.raw`C:\Users\wangqiyuan\project\cursor\aicodegame\src\app\(dashboard)\layout.tsx`),{__esModule:a,$$typeof:l}=r,n=r.default}};